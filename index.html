
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&display=swap" rel="stylesheet">
</head>

<style>
font-family: 'Roboto Mono', monospace, arial, sans-serif;

*,
*::before,
*::after {
  box-sizing: border-box;
}

html, body {
  height: 100%;
  width: 100%;
  margin: 0;
  padding: 0;
}

@keyframes gradientFlow {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

body {
  font-family: 'Roboto Mono', monospace, arial, sans-serif;
  margin: 0;
  padding: 0;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  background: linear-gradient(135deg, #1594eb, #A36AFF, #60D394, #FF8C42);
  background-size: 600% 600%;
  animation: gradientFlow 15s ease infinite;
  color: white;
  overflow-x: hidden; 
}

.main-layout {
  display: flex;
  flex-direction: column; 
  justify-content: center; 
  align-items: center; 
  max-width: 900px;
  margin: 20px auto;
  gap: 20px;
  padding: 40px; 
  width: 95%;
}

.calculator,
.roles-container {
  display: flex;
  flex-direction: column;
  flex: 1 1 0;
  width: 100%;
  max-width: 700px;
  box-sizing: border-box;
  margin-bottom: 0;
  padding: 20px;
  background-color: #070212;
  color: #d96057;
  border: 4px solid #0a0909;
  border-radius: 10px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  text-align: left;
}

.roles-container {
  flex-direction: row;
  align-items: flex-start;
  padding: 20px;
  width: 100%;
  box-sizing: border-box;
}

.button-column {
  display: flex;
  flex-direction: column;
  gap: 10px;
  width: 100px;
  margin-right: 10px; 
}

.button-column button {
  font-size: 14px;      
  padding: 8px 8px;     
  width: 90px;         
  box-sizing: border-box;
}

.roles-column {
  display: flex;
  gap: 10px;
  width: 100%;
  margin-left: 10px; 
}

.roles-column > div {
  max-width: 400px;
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 5px;
  flex: 1;
}

.role-btn {
  font-size: 11px;
  width: 150px;
  height: 35px;
  background-color: #555555;
  color: white;
  border: 2px solid #ddd;
  cursor: pointer;
  font-weight: normal;
  border-radius: 5px;
  transition: background-color 0.3s, transform 0.3s, border-color 0.3s;
  margin: 5px 0;
  padding: 0 10px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.role-btn:hover {
  background-color: #777777;
  color: white;
  transform: scale(1.1);
  border-color: #eee;
}

.role-btn.active {
  background-color: #A36AFF;
  color: white;
  border: 2px solid #7B52CC;
  font-weight: normal;
  box-shadow: 0 0 8px #A36AFF;
}

.action-btn {
  width: 100%;
  background-color: #60D394;
  color: black;
  font-weight: 700;
  Border-radius: 6px;
}

.action-btn:hover {
  background-color: #4fbf7b;
  color: white;
  transform: scale(1.05);
}

#calculateBtn {
  background-color: #1594eb;
  color: black;
  font-weight: 600;
  border: 2px solid #1594eb;
  border-radius: 6px;
  box-shadow: 0 0 8px #1594eb;
}

#calculateBtn:hover {
  background-color: #0f76d6;
  box-shadow: 0 0 12px #0f76d6;
  color: white;
}

#clearAllBtn {
  background-color: #FF8C42;
  color: black;
  border: 2px solid #d76f29;
  border-radius: 6px;
  box-shadow: 0 0 8px #FF8C42;
}

#clearAllBtn:hover {
  background-color: #d76f29;
  color: white;
}

#clearRolesBtn {
  background-color: #A36AFF;
  color: black;
  border: 2px solid #864fcc;
  box-shadow: 0 0 8px #A36AFF;
}

#clearRolesBtn:hover {
  background-color: #864fcc;
  color: white;
}

.addBtn {
   background-color: #4caf50;
   color: black;
   border: none;
   padding: 0px 20px;
   text-align: center;
   display: inline-block;
   font-size: 30px;
   margin: 4px 2px;
   transition-duration: 1s;
   cursor: pointer;
   border-radius: 50px;
}

.addBtn:hover {
   background-color: lightgreen;
   transform: scale(1.2);

}

.action-btn:hover {
   opacity: 0.4;
   transform: scale(1.1);
}

h1, h2 {
  text-align: center;
  font-size: 22px;
  margin-bottom: 10px;
}

.tab {
  display: flex;
  justify-content: center;
  gap: 60px;
  border: 4px solid #0a0909;
  background-color: #171721;
  border-radius: 20px;
  padding: 2px 0; 
  width: 100%;
  box-sizing: border-box;
}

.tab button {
  background-color: #171721;
  color: #60D394; 
  font-weight: bold;
  font-family: Calibri, sans-serif;
  font-size: 18px;       
  padding: 6px 10px;   
  border: 2px solid transparent;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s, color 0.3s, transform 0.2s;
  min-width: 160px;      
  margin: 5px 10px;
}

.tab button:hover {
  background-color: #60D394;
  color: white;
  transform: scale(1.05);
  border-color: #1594eb;
}

.tab button.active {
  background-color: #60D394;
  color: black;
  border: 2px solid #A36AFF;
  box-shadow: 0 0 8px #A36AFF;
  transform: scale(1.05);
}

.tabcontent {
  display: none;
  padding: 16px;
  border: 4px solid #0a0909;
  border-radius: 20px;
  margin-top: 10px;
  min-height: 300px;
  width: 100%;
  box-sizing: border-box;
}

.tabcontent.active {
  display: block;
}

.item-price,
.inline,
.roles-content {
   display: flex;
   align-items: center;
   justify-content: space-between;
   margin-bottom: 15px;
}

.item-price select,
.calculator input[type="number"] {
   padding: 8px;
   border: 3px solid #2b2727;
   border-radius: 22px;
   background-color: #694542;
   color: black;
}

.item-price span {
   width: 45%;
   text-align: right;
   overflow: hidden;
   white-space: nowrap;
   text-overflow: ellipsis;
}

.summary,
.roles-content {
   margin-top: 10px;
   margin-bottom: 10px;
   max-height: 300px; 
   overflow-y: auto;  
}

.roles-container .role-label {
   font-size: 50%;
   display: grid;
   grid-template-columns: repeat(4, 1fr); 
   background-color: grey;
   gap: 10px; 
   color: white;
   padding: 10px;
   border-radius: 20px;
   margin: 20px auto;
   cursor: pointer;
   transition: background-color 0.3s;
   border: 1px solid lightgrey;
}

.role-btn {
  width: 100%; 
  min-width: auto; 
  margin: 0; 
}

.roles-container .role-label.active {
   background-color: #add8e6;
   color: white;
}

.summary {
   display: flex;
   flex-direction: column;
   align-items: flex-start;
   margin-top: 10px;
   margin-bottom: 10px;
}

.summary div {
   font-size: 14px;
   font-family: Arial Unicode MS, sans-serif;
   color: lightgrey;
   margin: 2px;
   margin-left: 12px;
   text-align: left;
   width: 100%;
}

.summary .removeOneBtn {
   background-color: orange;
   color: black;
   border: none;
   border-radius: 50%;
   padding: 3px 6px;
   font-weight: bold;
   cursor: pointer;
   transition: background-color 0.2s, transform 0.2s;
}

.summary .removeOneBtn:hover {
   background-color: darkorange;
   transform: scale(1.2);
}

.summary .removeAllBtn {
  background-color: #A36AFF !important;
  color: black !important;
  border: none;
  border-radius: 50%;
  padding: 3px 6px;
  font-weight: bold;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.2s;
}

.summary .removeAllBtn:hover {
   background-color: #864fcc;
   transform: scale(1.2);
}

.tabcontent label {
   margin-right: 5px;
}

#buyItemButtons,
#itemButtons {
   display: flex;
   flex-wrap: wrap;
   justify-content: flex-start;
}

.item-button {
   display: inline-block;
   width: 135px;
   padding: 10px;
   padding-left: 2px;
   margin: 5px;
   font-size: 11.5px;
   background-color: #444;
   color: white;
   border: 2px solid darkgrey;
   text-align: center;
   cursor: pointer;
   border-radius: 5px;
   transition: background-color 0.2s, transform 0.2s;
   white-space: nowrap;
}

.item-button:hover {
   background-color: #555;
   transform: scale(1.08);
}

.return-button {
  background-color: #4caf50; 
  color: white;
  border: none;
  padding: 10px;
  cursor: pointer;
  font-weight: bold;
  border-radius: 50px;
  transition: background-color 0.3s, transform 0.3s;
  position: absolute;
  top: 10px;
  right: 10px;
}

.return-button:hover {
  background-color: #388e3c; 
  transform: scale(1.1);
}
.logo-heading {
  font-family: 'Black Ops One', cursive;
  font-size: 32px; 
  color: #FF8C42;
  text-align: center;
  margin-bottom: 10px;
}
.site-footer {
  background-color: #171721; 
  color: #d96057;            
  text-align: center;
  padding: 15px 10px;
  font-size: 14px;
  border-top: 4px solid #2b2727; 
  margin-top: 40px;
  font-family: 'Roboto Mono', monospace, arial, sans-serif; 
}
.modal {
  display: none;
  position: fixed;
  z-index: 999;
  padding-top: 80px;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.8);
}

.modal-content {
  background-color: #1a1a1a;
  margin: auto;
  padding: 20px;
  border: 2px solid orange;
  width: 80%;
  max-height: 80vh;
  overflow-y: auto;
  color: white;
  white-space: pre-wrap;
  font-family: monospace;
  border-radius: 12px;
}

.modal-content .close {
  color: orange;
  float: right;
  font-size: 28px;
  font-weight: bold;
  cursor: pointer;
}

@media (max-width: 600px) {
.main-layout {
    flex-direction: column;
    padding: 10px;
    width: 100%;
    max-width: 100%;
    padding-right: 15px;
    box-sizing: border-box;
  }

.calculator,
.roles-container {
   flex-direction: column;
   max-width: 100%;
   width: 100%;
   padding: 10px;
  }

.roles-container {
   display: flex;
   flex-direction: row;
   flex-wrap: wrap;
   gap: 10px;
   justify-content: center;
   width: 100%;
  }

.roles-column {
   flex-direction: column;
   margin-left: 0;
   gap: 10px;
  }

.roles-column > div {
   display: grid;
   grid-template-columns: 1fr 1fr;
   gap: 8px;
   width: 100%;
  }

.role-btn {
   width: 100%;
   min-width: 0;
   font-size: 13px;
   white-space: normal;
   padding: 8px 6px;
  }

.button-column {
   width: 100%;
   margin-right: 0;
   margin-bottom: 15px;
   flex-direction: row;
   justify-content: space-around;
   gap: 5px;
  }

.button-column button,
 #calculateBtn {
   width: 100%;
   font-size: 16px;
   padding: 12px 10px;
   min-width: 80px;
  }

.tab {
   gap: 10px;
   flex-wrap: wrap;
  }

.tab button {
   flex: 1 1 100%;
   font-size: 14px;
   padding: 10px;
  }

#buyItemButtons,
#itemButtons {
  display: grid !important; /* override flex */
  grid-template-columns: repeat(3, 1fr);
  gap: 6px;
  justify-items: center;
  padding-top: 50px; 
  position: relative; 
}

.return-button {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 1000; /* make sure it stays above everything */
}

.item-button {
  width: 100% !important;  
  max-width: 110px;
   font-size: 13px;
   padding: 8px 6px;
   margin: 4px;
   white-space: normal;
  }

.summary {
   max-height: 300px;
   overflow-y: auto;
   font-size: 14px;
  }

.modal-content {
   width: 95%;
   max-height: 70vh;
   padding: 15px;
   font-size: 14px;
  }
}
</style>

<body>
  <div class="main-layout">

    <!-- Calculator Section -->
    <div class="calculator">
    <h1 class="logo-heading">B L O O D L I N E Z</h1>

      <!-- Tabs -->
      <div class="tab">
        <button class="tablinks" data-tab="buyTab">Buy</button>
        <button class="tablinks" data-tab="sellTab">Sell</button>
      </div>

      <!-- Buy Tab -->
      <div class="tabcontent" align="left" id="buyTab">
        <div id="buyItemButtons" style="position: relative;">
          <!-- Buttons for categories/items will be dynamically added here -->
        </div>
        <div id="buySummary" class="summary"></div>
      </div>

      <!-- Sell Tab -->
      <div class="tabcontent" id="sellTab">
        <div id="itemButtons" style="position: relative;">
          <!-- Buttons for categories/items will be dynamically added here -->
        </div>
        <div id="sellSummary" class="summary"></div>
      </div>
    </div>

<!-- Roles Container Section -->
<div class="roles-container">
  <div class="button-column">
    <button id="calculateBtn" class="action-btn">Calculate</button>
    <button id="clearAllBtn" class="action-btn">Clear All</button>
    <button id="clearRolesBtn" class="action-btn">Clear Roles</button>

    <!-- Role bonus display -->
    <div id="bonus-wrapper" style="margin-top: 6px; color: orange; font-weight: normal; font-size: 1.1em;">
      Role Bonus: <span id="bonus-total">â‚µ0</span>
    </div>
  </div>

  <div class="roles-column">
    <div id="roleColumn1"></div>
    <div id="roleColumn2"></div>
  </div>
</div>

  </div> <!-- END main-layout -->

<footer class="site-footer">
  <p>Â© 2025 BloodlineZ. All rights reserved.</p>
  <p class="footer-subtext">Presented by BittaTism</p>
</footer>

<!-- Summary Modal -->
<div id="summaryModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <pre id="modalText"></pre>
  </div>
</div>

</body>

<script>

// Define Items and Prices

const buyitems = {

  "Kits": [
    { name: "Player Kit", price: 15000 }
  ],

"Weapons": {

"Guns": {

"Automatic": [

{ name: "Aug AX", price: 8500 },

{ name: "M4A1", price: 8500 },

{ name: "KAM", price: 8500 },

{ name: "KA101", price: 6500 },

{ name: "KAS74U", price: 5000 },

{ name: "VSS", price: 5000 },

{ name: "Bizon", price: 2500 },

{ name: "Vaiga", price: 5500 }

],

"Ranged": [

{ name: "LAR", price: 5500 },

{ name: "DMR", price: 8500 },

{ name: "M70 Tundra", price: 6500 },

{ name: "Savanna", price: 6500 },

{ name: "VS89", price: 8500 },

{ name: "VSD", price: 6500 },

{ name: "Mosin", price: 6500 }

],

"Melee & Pistols": [

{ name: "MKII", price: 500 },

{ name: "Revolver", price: 500 },

{ name: "FX45", price: 500 },

{ name: "Deagle", price: 500 },

{ name: "CR75", price: 500 },

{ name: "Combat Knife", price: 500 },

{ name: "Hunter Knife", price: 500 }

],

"Special": [

{ name: "M79", price: 10000 }

]

},

"Attachments": {

"Suppressors": [

{ name: "Standardized Suppressor", price: 7500 },

{ name: "Normalized Suppressor", price: 7500 },

{ name: "Pistol Suppressor", price: 1000 },

{ name: "Bottle Suppressor", price: 2000 }

],

"Weapon Parts": [

{ name: "LAR Lightweight Buttstock", price: 50 },

{ name: "LAR Polymer Buttstock", price: 50 },

{ name: "M4 CQB Buttstock", price: 50 },

{ name: "M4 Polymer Handguard", price: 50 },

{ name: "M4 MP Handguard", price: 50 },

{ name: "Universal Flashlight", price: 500 }

]

},

"Optics": {

"Short Range": [

{ name: "Red Dot", price: 100 },

{ name: "Backup Ironsight", price: 200 },

{ name: "Combat Sight", price: 200 },

{ name: "Mini Sight", price: 200 },

{ name: "Kobra Sight", price: 200 },

{ name: "ATOG 4x", price: 200 },

{ name: "P187 Scope", price: 600 }

],

"Long Range": [

{ name: "ATOG 6x", price: 400 },

{ name: "PU Scope", price: 200 },

{ name: "PSO-1 Scope", price: 400 },

{ name: "PSO-1-1 Scope", price: 400 },

{ name: "PSO-6 Scope", price: 800 },

{ name: "Hunter Scope", price: 450 },

{ name: "Marksman Scope", price: 1000 }

],

"NV Optics": [

{ name: "Starlight NV", price: 1000 },

{ name: "Kazuar NV", price: 1000 }

]

},

"Magazines": {

"Auto Mags": [

{ name: "40 Rnd C-Mag", price: 1200 },

{ name: "60 Rnd C-Mag", price: 1500 },

{ name: "30 Rnd KAM Poly Mag", price: 500 },

{ name: "75 Rnd KAM Mag", price: 1500 },

{ name: "20 Rnd Vaiga Mag", price: 500 },

{ name: "20 Rnd DMR Mag", price: 1000 },

{ name: "45 Rnd 74U Mag", price: 1000 },

{ name: "20 Rnd VSS Mag", price: 500 },

{ name: "64 Rnd Bizon Mag", price: 250 },

{ name: "30 Rnd AUR Mag", price: 350 }

],

"Sniper Mags": [

{ name: "20 Rnd DMR Mag", price: 1000 },

{ name: "20 Rnd LAR Mag", price: 600 },

{ name: "10 Rnd VSD Mag", price: 500 },

{ name: "10 Rnd Savanna Mag", price: 500 },

{ name: "10 Rnd VS89 Mag", price: 500 }

],

"Pistol Mags": [

{ name: "MKII Mag", price: 50 },

{ name: "CR75 Mag", price: 50 },

{ name: "FX45 Mag", price: 100 },

{ name: "Deagle Mag", price: 100 }

]

},

"Ammo": [

{ name: ".357", price: 500, bulkOptions: [1, 5, 10] },

{ name: ".380ACP", price: 500, bulkOptions: [1, 5, 10] },

{ name: ".22 LR", price: 500, bulkOptions: [1, 5, 10] },

{ name: "9x39mm", price: 100, bulkOptions: [1, 5, 10] },

{ name: "9x19mm", price: 50, bulkOptions: [1, 5, 10] },

{ name: "5.56x45", price: 1000, bulkOptions: [1, 5, 10] },

{ name: ".308 WIN", price: 1000, bulkOptions: [1, 5, 10] },

{ name: "545x39", price: 850, bulkOptions: [1, 5, 10] },

{ name: "7.62x39", price: 850, bulkOptions: [1, 5, 10] },

{ name: "7.62x54mmR", price: 1000, bulkOptions: [1, 5, 10] },

{ name: ".45ACP", price: 500, bulkOptions: [1, 5, 10] },

{ name: "12GA Buck", price: 850, bulkOptions: [1, 5, 10] },

{ name: "12GA Rubber", price: 550, bulkOptions: [1, 5, 10] },

{ name: "12GA Rifled", price: 850, bulkOptions: [1, 5, 10] }

]

},

"Clothing": {

"Headgear": [

{ name: "Assault Helmet", price: 1000 },

{ name: "Assault Visor", price: 200 },

{ name: "Tactical Helm", price: 600 },

{ name: "NV Goggles", price: 2500 },

{ name: "NVG Strap", price: 300 },

{ name: "Witch Hood", price: 500 },

{ name: "Cowboy Hat", price: 300 }

],

"Jackets": [

{ name: "BDU Jacket", price: 400 },

{ name: "Combat Jacket", price: 300 },

{ name: "Field Jacket", price: 600 },

{ name: "CUU Jacket", price: 300 },

{ name: "Hunter Jacket", price: 500 },

{ name: "Down Jacket", price: 400 },

{ name: "OMK Jacket", price: 300 },

{ name: "Tactical Shirt", price: 300 }

],

"Backpacks": [

{ name: "Field Bag", price: 600 },

{ name: "Hunter Backpack", price: 400 },

{ name: "Tactical Backpack", price: 400 },

{ name: "Skull Backpack", price: 500 },

{ name: "Combat Backpack", price: 400 },

{ name: "Black Drypack", price: 400 },

{ name: "Assault Bag", price: 200 }

],

"Vests": [

{ name: "Plate Carrier", price: 1800 },

{ name: "Pouches", price: 200 },

{ name: "Holster", price: 50 },

{ name: "Field Vest", price: 1800 },

{ name: "Assault + Pack", price: 250 }

],

"Pants": [

{ name: "BDU Pants", price: 300 },

{ name: "Combat Pants", price: 200 },

{ name: "Cargo Pants", price: 500 },

{ name: "CUU Pants", price: 300 },

{ name: "Hunter Pants", price: 500 },

{ name: "OMK Pants", price: 300 }

],

"Misc Clothing": [

{ name: "Gloves", price: 200 },

{ name: "Sheath", price: 50 },

{ name: "Belt", price: 150 },

{ name: "Hip Pack", price: 250 }

],

"Boots": [

{ name: "Assault Boots", price: 300 },

{ name: "Jungle Boots", price: 200 },

{ name: "Hunter Boots", price: 200 }

],

"Ghillie": [

{ name: "Ghillie Suit", price: 1800 },

{ name: "Ghillie Hood", price: 800 },

{ name: "Ghillie Rifle Wrap", price: 500 }

],

"Face": [

{ name: "All Ski Masks", price: 200 },

{ name: "Mime Mask", price: 100 },

{ name: "Carnival Mask", price: 100 }

]

},

"Meds": [

{ name: "Bandages (2-pack)", price: 50 },

{ name: "Saline Bag", price: 250 },

{ name: "Tetracycline", price: 200 },

{ name: "Charcoal Tablets", price: 200 },

{ name: "Multi Vitamins", price: 100 },

{ name: "PoX Antidote", price: 300 },

{ name: "Codeine Pills", price: 250 },

{ name: "Morphine Injector", price: 100 },

{ name: "Blood Test Kit", price: 100 },

{ name: "Blood Collection Kit", price: 50 },

{ name: "IV Start Kit", price: 50 },

{ name: "Chlorine Tablets", price: 100 }

],

"NBC Gear": [

{ name: "NBC Filters", price: 100, bulkOptions: [1, 2, 5] },

{ name: "NBC Masks", price: 300, bulkOptions: [1, 2, 5] },

{ name: "NBC Hood", price: 1000, bulkOptions: [1, 2, 5] },

{ name: "NBC Jacket", price: 1000, bulkOptions: [1, 2, 5] },

{ name: "NBC Pants", price: 1000, bulkOptions: [1, 2, 5] },

{ name: "NBC Boots", price: 500, bulkOptions: [1, 2, 5] },

{ name: "NBC Gloves", price: 500, bulkOptions: [1, 2, 5] }

],

"Miscellaneous": [

{ name: "Punchcard", price: 50000 },

{ name: "Canteen", price: 100 },

{ name: "Tourist Map", price: 0 },

{ name: "9V Batteries (4-pack)", price: 50, bulkOptions: [1, 5, 10] },

{ name: "Bear Trap", price: 500 },

{ name: "Construction Light", price: 400 },

{ name: "Cable Reel", price: 400 },

{ name: "Faction Flags", price: 0 },

{ name: "Power Generator", price: 800 },

{ name: "Megaphone", price: 300 },

{ name: "Gun Cleaning Kit", price: 400 },

{ name: "Duct Tape", price: 200 },

{ name: "Sewing Kit", price: 300 },

{ name: "Leather Repair Kit", price: 300 },

{ name: "Epoxy Putty", price: 400 },

{ name: "Rangefinder", price: 400 },

{ name: "Canned Bacon", price: 200 },

{ name: "Electrical Repair Kit", price: 400 },

{ name: "Compass", price: 200 }

],

"Explosives": {

"IED Components": [

{ name: "IED Container", price: 600 },

{ name: "Detonator", price: 1000 }

],

"Other Explosives": [

{ name: "US/RUS Grenades", price: 300, bulkOptions: [1, 5, 10] },

{ name: "POX Vial", price: 500, bulkOptions: [1, 2, 5] },

{ name: "Flashbangs", price: 50, bulkOptions: [1, 2, 5] },

{ name: "Smoke Nades", price: 200, bulkOptions: [1, 2, 5] },

{ name: "Land Mines", price: 2000, bulkOptions: [1, 5, 10] },

{ name: "40MM Pox Grenade", price: 6000, bulkOptions: [1, 5, 10] },

{ name: "40MM Smoke", price: 200, bulkOptions: [1, 5, 10] },

{ name: "Claymores", price: 500 }

]

},

"Storage": [

{ name: "Car Tent", price: 4000 },

{ name: "Large Tent", price: 3000 },

{ name: "Medium Tent", price: 1500 },

{ name: "Canopy Tent", price: 1200 },

{ name: "Sea Chest", price: 1000 },

{ name: "Barrel", price: 1200, bulkOptions: [1, 2, 5] },

{ name: "Ammo Box", price: 50, bulkOptions: [1, 2, 5] }

],

"Building": [

{ name: "Box of Nails", price: 7000, bulkOptions: [1, 5] },

{ name: "Sharpening Stones", price: 500, bulkOptions: [1, 5, 10] },

{ name: "4Dial Combo Lock", price: 3500, bulkOptions: [1, 5, 10] },

{ name: "3Dial Combo Lock", price: 1750, bulkOptions: [1, 5, 10] },

{ name: "Hammer", price: 300 },

{ name: "Hatchet", price: 500 },

{ name: "Hacksaws", price: 400 },

{ name: "Sledgehammer", price: 300 },

{ name: "Pickaxe", price: 400 },

{ name: "Field Shovel", price: 400 },

{ name: "Crowbar", price: 300 },

{ name: "Fireaxe", price: 400 },

{ name: "Metal Wire", price: 400, bulkOptions: [1, 2, 5] },

{ name: "Barbwire", price: 300, bulkOptions: [1, 2, 5] },

{ name: "Pliers", price: 3500 },

{ name: "Camo Netting", price: 1000 },

{ name: "Rope", price: 500, bulkOptions: [1, 5, 10] }

],

"Vehicles": {

"Repair": [

{ name: "Blowtorch", price: 400 },

{ name: "Gas Canister", price: 250 },

{ name: "Tire Repair Kit", price: 200 },

{ name: "Battery Charger", price: 400 }

],

"Parts": [

{ name: "Spark Plug", price: 200 },

{ name: "Glow Plug", price: 400 },

{ name: "Car Battery", price: 200 },

{ name: "Truck Battery", price: 400 },

{ name: "Car Radiator", price: 200 }

],

"Tires": [

{ name: "Car Tires", price: 300 },

{ name: "Humvee Tires", price: 800 },

{ name: "Truck Tires", price: 400 }

]

}

};

// --- SELL ITEMS ---
const sellitems = {
  Sets: [
    { name: "Teddy Bears (4/4)", price: 500, bulkOptions: [1, 5, 10] },
    { name: "Payday Masks (4/4)", price: 2500, bulkOptions: [1, 5, 10] },
    { name: "Fish (5/5)", price: 1000, bulkOptions: [1, 5, 10] },
    { name: "Sneakers (5/5)", price: 1000, bulkOptions: [1, 5, 10] }
  ],
  Pelts: {
    Wild: [
      { name: "Deer Pelt", price: 500, bulkOptions: [1, 5, 10] },
      { name: "Boar Pelt", price: 500, bulkOptions: [1, 5, 10] },
      { name: "Wolf Pelt", price: 600, bulkOptions: [1, 5, 10] },
      { name: "Bear Pelt", price: 1000, bulkOptions: [1, 5, 10] }
    ],
    Domestic: [
      { name: "Goat Pelt", price: 100, bulkOptions: [1, 5, 10] },
      { name: "Cow Pelt", price: 100, bulkOptions: [1, 5, 10] },
      { name: "Sheep Pelt", price: 100, bulkOptions: [1, 5, 10] }
    ],
    Processed: [
      { name: "Tanned Leather (8/8)", price: 1000, bulkOptions: [1, 5] }
    ]
  },
  Other: [
    { name: "Syringe", price: 100, bulkOptions: [1, 5, 10] },
    { name: "Pens", price: 100, bulkOptions: [1, 5, 10] },
    { name: "Cigarettes", price: 100, bulkOptions: [1, 10, 50] },
    { name: "Books", price: 100, bulkOptions: [1, 5, 20] },
    { name: "Filled Blood Bag", price: 100, bulkOptions: [1, 5, 20] },
    { name: "Cassette Tape", price: 100, bulkOptions: [1, 5, 20] },
    { name: "Radio", price: 500, bulkOptions: [1, 5, 20] },
    { name: "Spray Paint", price: 500, bulkOptions: [1, 5, 20] },
    { name: "Oil", price: 1500, bulkOptions: [1, 5, 20] },
    { name: "Brake Fluid", price: 500, bulkOptions: [1, 5, 20] },
    { name: "Cocaine", price: 500, bulkOptions: [1, 5, 20] },
    { name: "Mess Tin", price: 500, bulkOptions: [1, 5, 20] },
    { name: "Bible", price: 10000 },
    { name: "Golden Deagle", price: 2500 },
    { name: "Engraved 1911", price: 500 },
    { name: "Pink Derringer", price: 3000 },
    { name: "Faction Flag", price: 15000 },
    { name: "Cannabis", price: 200, bulkOptions: [1, 10, 50] }
  ]
};


const roles = {
  "Operation Smoke Stack": {
    description: "Sell 250 cigarettes at once â†’ Each pack sells for â‚µ500 after",
    bonuses: {
      "Cigarettes": 500
    }
  },
  "Ink Kingpin": {
    description: "Sell 250 pens at once â†’ Pens sell for â‚µ250 each",
    bonuses: {
      "Pens": 250
    }
  },
  "Signal Junkie": {
    description: "Turn in 25 radios & 25 cassettes â†’ 25% off electronics at trader",
    discounts: {
      "NV Googles": 25
    }
  },
  "Krush Cartel": {
    description: "Grow & sell 10 crates weed at once â†’ Future weed sells for â‚µ400 per crate",
    bonuses: {
      "Cannabis": 400
    }
  },
  "White Gold Mover": {
    description: "Sell 150 cocaine units â†’ Units now sell for â‚µ1,000 each",
    bonuses: {
      "Cocaine": 1000
    }
  },
  "Desert Demon": {
    description: "Kill with Gold Deagle â†’ 50% off pistols & ammo",
    discounts: {
      "Deagle": 50,
      ".357": 50,
      "9x19mm": 50,
      ".45ACP": 50,
      "MKII": 50, 
      "Revolver": 50,
      "FX45": 50,
      "CR75": 50,
      ".380ACP": 50,
      ".22 LR": 50
    }
  },
  "Book of ProfitZ": {
    description: "Sell 300 books & 1 bible at once â†’ Books sell for â‚µ300 each; bibles sell for â‚µ20,000",
    bonuses: {
      "Books": 300,
      "Bible": 20000
    }
  },
  "Pit Boss": {
    description: "Turn in 25 deer steaks, 15 boar & 15 bear steaks (cooked, not rotten) â†’ â‚µ10,000 + 10% off food & drinks",
    bonuses: {
      "Food Bonus": 10000 // placeholder for the lump sum bonus
    },
    discounts: {
      "Canned Bacon": 10
    }
  },
  "Wild Game Warlord": {
    description: "Turn in 10 bears, 10 boar, 20 wolves, 20 deer/reindeer, 10 rabbits",
    bonuses: {
      "Bear Pelt": 1500,  
      "Boar Pelt": 750,
      "Wolf Pelt": 900,
      "Deer Pelt": 750
      // Note: rabbits not included since no data in pelts, you can add if needed
    }
  },
  "Domestic Dominator": {
    description: "Turn in 20 goats, 20 cows & 20 sheep pelts â†’ Domestic pelts sell for double",
    bonuses: {
      "Goat Pelt": 200,
      "Cow Pelt": 200,
      "Sheep Pelt": 200
    }
  },
  "Bear Broker": {
    description: "Turn in 5 sets of teddy bears (4 colors per set) â†’ â‚µ2,500 per set",
    bonuses: {
      "Teddy Bears (4/4)": 2500
    }
  },
  "Sneaker Head": {
    description: "Turn in all 5 sets of sneaker colors â†’ Earn â‚µ2,500 per set",
    bonuses: {
      "Sneakers (5/5)": 2500
    }
  },
  "Master Baiter": {
    description: "Turn in 25 Mackerel & 25 Carp or 25 Pollock & 25 Trout. Get $15K and the role.",
    bonuses: {
      "Fish (5/5)": 1500
    }
  },
  "Trap God": {
    description: "Kill 4 players using traps like claymores, landmines, or tripwires. Get 50% off traps.",
    discounts: {
      "Land Mines": 50,
      "Bear Trap": 50,
      "Claymores": 50
    }
  },
  "Cap Collector": {
    description: "Turn in 9 different ball caps. Get â‚µ3500 and half off helmets for life.",
    bonuses: {
      "Cap Bonus": 3500
    },
    discounts: {
      "Assault Helmet": 50,
      "Tactical Helm": 50
    }
  },
  "Boom Buddy": {
    description: "Kill 2 players with 1 plastic explosive or claymore. Get 15% off explosives.",
    discounts: {
      "US/RUS Grenades": 15,
      "POX Vial": 15,
      "Flashbangs": 15,
      "Land Mines": 15,
      "40MM Pox Grenade": 15,
      "Claymores": 15
    }
  },
  "Brain Surgeon": {
    description: "Get 100 headshots. All ammo and mags are 50% off.",
    discounts: {
      ".357": 50,
      ".380ACP": 50,
      ".22 LR": 50,
      "9x39mm": 50,
      "9x19mm": 50,
      "5.56x45": 50,
      ".308 WIN": 50,
      "545x39": 50,
      "7.62x39": 50,
      "7.62x54mmR": 50,
      ".45ACP": 50,
      "12GA Buck": 50,
      "12GA Rubber": 50,
      "12GA Rifled": 50,
      "40 Rnd C-Mag": 50,
      "60 Round C-Mag": 50,
      "30 Rnd KAM Poly Mag": 50,
      "75 Rnd KAM Mag": 50,
      "20 Rnd Vaiga Mag": 50,
      "30 Rnd AUR Mag": 50,
      "45 Rnd 74U Mag": 50,
      "20 Rnd VSS Mag": 50,
      "64 Rnd Bizon Mag": 50,
      "20 Rnd DMR Mag": 50,
      "20 Rnd LAR Mag": 50,
      "10 Rnd VSD Mag": 50,
      "10 Rnd Savanna Mag": 50,
      "10 Rnd VS89 Mag": 50
    }
  },
  "Scope Fiend": {
    description: "Land 10 sniper kills from over 500 yards. Get 50% off sniper ammo.",
    discounts: {
      "7.62x54mmR": 50,
      ".308 WIN": 50
    }
  },
  "Whisper Shot": {
    description: "Snipe and kill from 850 yards. Get 25% off sniper rifles.",
    discounts: {
      "LAR": 25,
      "DMR": 25,
      "M70 Tundra": 25,
      "Savanna": 25,
      "VS89": 25,
      "VSD": 25,
      "Mosin": 25
    }
  },
  "Dexter": {
    description: "Turn in 100 blood bags receive 10% off all medical supplies",
    discounts: {
      "Bandages (2-pack)": 10,
      "Saline Bag": 10,
      "Tetracycline": 10,
      "Charcoal Tablets": 10,
      "Multi Vitamins": 10,
      "PoX Antidote": 10,
      "Codeine Pills": 10,
      "Morphine Injector": 10,
      "Blood Test Kit": 10,
      "Blood Collection Kit": 10,
      "IV Start Kit": 10,
      "Chlorine Tablets": 10
    }
  },
  "Boom Daddy": {
    description: "turn in 50 complete IEDS.",
    bonuses: {
     "IEDS": 100000
    }
  },
  "First Bloodz": {
    description: " â€” receive 25% off at trader.",
    discounts: {
      // Apply 25% off all items (handle separately in your code),
      // or list popular items here for discount
    }
  },
  "Time Served": {
    description: " â€” receive 20% off at trader.",
    discounts: {
      // Apply 20% off all items (handle separately in your code),
    }
  },
  "First Responders": {
    description: "For our real-world heroes â€” receive 10% off at trader.",
    discounts: {
      // Apply 10% off all items (handle separately in your code),
      // or list popular items here for discount
    }
  },
  "Health Providers": {
    description: "For our nurse's doctors and general health providers - enjoy 10% off at trader.",
    discounts: {
      // Same as above - 10% off all or health-related items
    }
  },
  "Veterans": {
    description: "For active military & veterans â€” enjoy 10% off your trader purchases.",
    discounts: {
      // Same as above - 10% off all or certain categories
    }
  },
  "Road Rage": {
    description: "Run over a geared player (not in safe zone). Earn the role + 10% off vehicle parts.",
    discounts: {
      "Spark Plug": 10,
      "Glow Plug": 10,
      "Car Battery": 10,
      "Truck Battery": 10,
      "Car Radiator": 10,
      "Car Tires": 10,
      "Humvee Tires": 10,
      "Truck Tires": 10
    }
  },
  "The Grey": {
    description: "Kill a wolf with a knife and record it. 10% off knives.",
    discounts: {
      "Combat Knife": 10,
      "Hunter Knife": 10
    }
  } 
};

const roleBonuses = {
  "Pit Boss": 10000,
  "Cap Collector": 3500,
  "Boom Daddy": 100000,
};

const itemsWithRoleTurnIn = new Set([
  "Cigarettes",
  "Pens",
  "Radio",
  "Cassette Tape",
  "Cannabis",
  "Cocaine",
  "Golden Deagle",
  "Bible",
  "Books",
  "Deer Pelt",
  "Boar Pelt",
  "Bear Pelt",
  "Wolf Pelt",
  "Goat Pelt",
  "Cow Pelt",
  "Sheep Pelt",
  "Teddy Bears (4/4)",
  "Fish (5/5)",
  "Sneakers (5/5)",
  "Mackerel",    
  "Carp",        
  "Pollock",     
  "Trout",       
  "Filled Blood Bag"    
]);


// END OF ITEMS AND ROLES

document.addEventListener("DOMContentLoaded", function() {
const buyItemButtonsDiv = document.getElementById("buyItemButtons");
const sellItemButtonsDiv = document.getElementById("itemButtons");
const sellSummaryDiv = document.getElementById("sellSummary");
const buySummaryDiv = document.getElementById("buySummary");
const rolesContainer1 = document.getElementById("roleColumn1");
const rolesContainer2 = document.getElementById("roleColumn2");
const clearAllBtn = document.getElementById("clearAllBtn");
const clearRolesBtn = document.getElementById("clearRolesBtn");
const calculateBtn = document.getElementById("calculateBtn");
const tablinks = document.getElementsByClassName("tablinks");
let buyNavigationStack = [buyitems];
let sellNavigationStack = [sellitems];
populateBuyButtons(buyitems, buyItemButtonsDiv, true);
populateSellButtons(sellitems);
populateRoles();
attachEventListeners();
// Handle closing of modal
document.querySelector(".close").onclick = function () {
  document.getElementById("summaryModal").style.display = "none";
};
window.onclick = function (event) {
  if (event.target == document.getElementById("summaryModal")) {
    document.getElementById("summaryModal").style.display = "none";
  }
};

function populateBuyButtons(items, container, isTopCategory = false) {
container.innerHTML = "";
Object.keys(items).forEach((category) => {
let button = document.createElement("button");
button.textContent = category;
button.className = "item-button";
if (Array.isArray(items[category])) {
button.onclick = () => {
buyNavigationStack.push(items[category]);
container.innerHTML = "";
items[category].forEach((item) => {
let itemButton = document.createElement("button");
itemButton.textContent = item.name;
itemButton.className = "item-button";
itemButton.onclick = () => handleBuyItemClick(item);
container.appendChild(itemButton);
});

addReturnButton(container, "buy");
};

} else {
  button.onclick = () => {
    buyNavigationStack.push(items[category]); 
    populateBuyButtons(items[category], container, false);
  };
}

container.appendChild(button);
});

if (!isTopCategory) addReturnButton(container, "buy");
}

function addReturnButton(container, type) {
  let returnButton = document.createElement("button");
  returnButton.textContent = "â†";
  returnButton.className = "return-button";
  returnButton.onclick = () => {
    if (type === "sell") {
      if (sellNavigationStack.length > 1) {
        // Pop current category
        sellNavigationStack.pop();
        // Get previous category from stack
        const previousCategory = sellNavigationStack[sellNavigationStack.length - 1];
        // Repopulate buttons with previous category
        populateSellButtons(previousCategory);
      } else {
        // At root, reset to root sellitems
        sellNavigationStack = [sellitems];
        populateSellButtons(sellitems);
      }
    } else if (type === "buy") {
      if (buyNavigationStack.length > 1) {
        buyNavigationStack.pop();
        const previousCategory = buyNavigationStack[buyNavigationStack.length - 1];
        populateBuyButtons(previousCategory, container, buyNavigationStack.length === 1);
      } else {
        populateBuyButtons(buyitems, container, true);
      }
    }
  };
  container.appendChild(returnButton);
}

function populateBulkOptions(container, item, summaryDiv, type) {
  container.innerHTML = ""; // Clear container

  item.bulkOptions.forEach((quantity) => {
    let buttonText = `${item.name} x ${quantity}`;
    createButton(container, buttonText, () =>
      addItemToSummary(item.name, quantity, item.price, summaryDiv)
    );
  });

  // Only show Role Turn-In button for sell items that qualify and exclude Tanned Leather
  if (
    type === "sell" &&
    !item.name.startsWith("Tanned Leather") &&
    itemsWithRoleTurnIn.has(item.name)
  ) {
    createButton(container, "Role Turn-In", () => {
      handleRoleTurnIn(item, summaryDiv);
    });
  }

  addReturnButton(container, type); 
}

function handleBuyItemClick(item) {
if (item.bulkOptions) {
populateBulkOptions(buyItemButtonsDiv, item, buySummaryDiv, "buy");
} else {

addItemToSummary(item.name, 1, item.price, buySummaryDiv);
}

}

function handleSellItemClick(item) {
if (item.bulkOptions) {
populateBulkOptions(sellItemButtonsDiv, item, sellSummaryDiv, "sell");
} else {

addItemToSummary(item.name, 1, item.price, sellSummaryDiv);
}

}

function clearItemButtons(itemButtonsDiv) {
itemButtonsDiv.innerHTML = "";
}

function createButton(container, text, onClick, className = "item-button") {
let button = document.createElement("button");
button.textContent = text;
button.className = className;
button.onclick = onClick;
container.appendChild(button);
}

function addItemToSummary(itemName, quantity, basePrice, summaryDiv) {
let existingItemDiv = Array.from(summaryDiv.children).find(
(div) => div.dataset.itemName === itemName
);

if (existingItemDiv) {
let existingQuantity = parseInt(existingItemDiv.dataset.quantity);
let newQuantity = existingQuantity + quantity;
existingItemDiv.dataset.quantity = newQuantity;
updateSummaryItem(existingItemDiv, newQuantity, basePrice);
} else {

let div = document.createElement("div");
div.dataset.itemName = itemName;
div.dataset.quantity = quantity;
div.dataset.basePrice = basePrice;
updateSummaryItem(div, quantity, basePrice);
summaryDiv.appendChild(div);
}

if (itemName === "Bible") adjustBiblePricing(summaryDiv);
updateSummaries();
}

function adjustBiblePricing(summaryDiv) {
let bibleDiv = Array.from(summaryDiv.children).find(
(div) => div.dataset.itemName === "Bible"
);

if (bibleDiv) {
let quantity = parseInt(bibleDiv.dataset.quantity);

const hasBibleBoostRole = document
.querySelector('.role-btn[data-role="First Bloodz"]')
?.classList.contains("active");
let unitPrice = hasBibleBoostRole ? 20000 : 10000;
bibleDiv.dataset.basePrice = unitPrice;
updateSummaryItem(bibleDiv, quantity, unitPrice);
}

}

function handleRoleTurnIn(item, summaryDiv) {
  switch (item.name) {
    case "Cigarettes":
      // Operation Smoke Stack: Sell 250 cigarettes at once
      addItemToSummary(item.name, 250, 100, summaryDiv);
      break;

    case "Pens":
      // Ink Kingpin: Sell 250 pens at once
      addItemToSummary(item.name, 250, 250, summaryDiv);
      break;

    case "Radio":
    case "Cassette Tape":
      // Signal Junkie: Turn in 25 radios & 25 cassettes
      // Usually triggers discount, no direct add here (unless you want a fixed turn-in count)
      // If needed, add a fixed quantity of 25 each to summary:
      addItemToSummary("Radio", 25, item.price, summaryDiv);
      addItemToSummary("Cassette Tape", 25, item.price, summaryDiv);
      break;

    case "Cannabis":
      // Krush Cartel: Future weed sells for â‚µ400 per crate
      addItemToSummary(item.name, 10, 200, summaryDiv);
      break;

    case "Cocaine":
      // White Gold Mover: Sell 150 cocaine units at once
      addItemToSummary(item.name, 150, 1000, summaryDiv);
      break;

    case "Teddy Bears (4/4)":
      // Bear Broker: Turn in 5 sets of teddy bears (4 colors per set)
      addItemToSummary(item.name, 5, 500, summaryDiv);
      break;

    case "Sneakers (5/5)":
      // Sneaker Head: Turn in all 5 Converse sneaker colors
      addItemToSummary(item.name, 4, item.price, summaryDiv);
      break;

    case "Fish (5/5)":
     // Example: Turn in Mackerel + Carp
     addItemToSummary("Mackerel / Pollock", 25, 0, summaryDiv);
     addItemToSummary("Carp / Trout", 25, 0, summaryDiv);
     addItemToSummary("Master Baiter Reward", 1, 15000, summaryDiv);
     break;

    case "Books":
      // Book of ProfitZ: Sell 300 books & 1 bible at once
      addItemToSummary(item.name, 300, 100, summaryDiv);
      addItemToSummary("Bible", 1, 20000, summaryDiv);
      break;

    case "Bear Pelt":
    case "Boar Pelt":
    case "Wolf Pelt":
    case "Deer Pelt":
      // Wild Game Warlord: Turn in 10 bears, 10 boar, 20 wolves, 20 deer/reindeer, 10 rabbits
      addItemToSummary("Bear Pelt", 10, 1000, summaryDiv);
      addItemToSummary("Wolf Pelt", 20, 600, summaryDiv);
      addItemToSummary("Boar Pelt", 10, 500, summaryDiv);
      addItemToSummary("Deer Pelt", 20, 500, summaryDiv);
      addItemToSummary("Rabbit Pelt", 10, 0, summaryDiv);
      break;

    case "Goat Pelt":
    case "Cow Pelt":
    case "Sheep Pelt":
      // Domestic Dominator: Turn in 20 goat, 20 cow, 20 sheep pelts
      addItemToSummary("Goat Pelt", 20, 100, summaryDiv);
      addItemToSummary("Cow Pelt", 20, 100, summaryDiv);
      addItemToSummary("Sheep Pelt", 20, 100, summaryDiv);
      break;

    case "Filled Blood Bag":
    case "Blood Bag":
      // Dexter: Turn in 100 blood bags
      addItemToSummary(item.name, 100, item.price, summaryDiv);
      break;

    case "Mackerel":
    case "Carp":
    case "Pollock":
    case "Trout":
      // Master Baiter: Turn in 25 Mackerel & 25 Carp or 25 Pollock & 25 Trout
      addItemToSummary("Mackerel", 25, item.price, summaryDiv);
      addItemToSummary("Carp", 25, item.price, summaryDiv);
      addItemToSummary("Pollock", 25, item.price, summaryDiv);
      addItemToSummary("Trout", 25, item.price, summaryDiv);
      break;

    default:
      console.log("No role turn-in available for this item.");
  }
}

function applyRoleBonuses() {
  let totalBonus = 0;

  document.querySelectorAll(".role-btn.active").forEach((btn) => {
    const role = btn.dataset.role;
    if (roleBonuses[role]) {
      totalBonus += roleBonuses[role];
    }
  });

  // Show or update bonus display
  const bonusDiv = document.getElementById("bonus-total");
  if (bonusDiv) {
    bonusDiv.textContent = `â‚µ${totalBonus.toLocaleString()}`;
  }
}

function updateSummaryItem(div, quantity, basePrice) {
let itemName = div.dataset.itemName;
let discountedPrice = calculateDiscountedPrice(itemName, basePrice);
let totalPrice = discountedPrice * quantity;
div.innerHTML = `${itemName} x ${quantity} = ${totalPrice.toFixed(0)} Cr <button class="removeOneBtn" style="background-color: orange;">x</button><button class="removeAllBtn" style="background-color: red;">x</button>`;
div.querySelector(".removeOneBtn").addEventListener("click", () => {
removeOneItem(div);
});

div.querySelector(".removeAllBtn").addEventListener("click", () => {
let summaryDiv = div.parentElement;
summaryDiv.removeChild(div);
updateSummaries();
});

}

function removeOneItem(div) {
let quantity = parseInt(div.dataset.quantity);
if (quantity > 1) {
let newQuantity = quantity - 1;
div.dataset.quantity = newQuantity;
updateSummaryItem(div, newQuantity, parseFloat(div.dataset.basePrice));
} else {

let summaryDiv = div.parentElement;
summaryDiv.removeChild(div);
updateSummaries();
}

}
function populateSellButtons(category = sellitems) {
  const container = document.getElementById("itemButtons");
  clearItemButtons(container);

  Object.entries(category).forEach(([label, value]) => {
    createButton(container, label, () => {
      if (Array.isArray(value)) {
        // Push the leaf array category onto the navigation stack
        sellNavigationStack.push(value);

        // Show sellable items
        clearItemButtons(container);
        value.forEach(item => {
          let handler = () => handleSellItemClick(item);

          // Alerts for special items
          if (item.name === "Sneakers (5/5)") {
            handler = () => {
              alert("Add a backpack of choice.");
              handleSellItemClick(item);
            };
          } else if (item.name === "Teddy Bears (4/4)") {
            handler = () => {
              alert("Add a box of nails or suppressor of your choice!");
              handleSellItemClick(item);
            };
          } else if (item.name === "Payday Masks (4/4)") {
            handler = () => {
              alert("Add a plate carrier of choice.");
              handleSellItemClick(item);
            };
          } else if (item.name === "Cannabis") {
            handler = () => {
              alert("Each x1 Cannabis represents 1 full crate (50 slots).");
              handleSellItemClick(item);
            };
          }

          createButton(container, item.name, handler);
        });

        // Add return button anytime deeper than top level
        if (sellNavigationStack.length > 1) {
          addReturnButton(container, "sell");
        }
      } else {
        // Navigating deeper into an object category
        sellNavigationStack.push(value);
        populateSellButtons(value);
      }
    });
  });

  // Add return button if at top level and stack length > 1 (unlikely)
  if (sellNavigationStack.length > 1) {
    addReturnButton(container, "sell");
  }
}

function populateRoles() {
Object.keys(roles).forEach((role) => {
let button = document.createElement("button");
button.classList.add("role-btn");
button.textContent = role;
button.dataset.role = role;
let container = document.createElement("div");
container.appendChild(button);
if (Object.keys(roles).indexOf(role) % 2 === 0) {
rolesContainer1.appendChild(container);
} else {

rolesContainer2.appendChild(container);
}

});

}

function attachEventListeners() {
document.querySelectorAll(".role-btn").forEach((button) => {
button.addEventListener("click", function() {
this.classList.toggle("active");
updateRoleEffects();
applyRoleBonuses();
});

});

clearAllBtn.addEventListener("click", clearAllTransactions);
clearRolesBtn.addEventListener("click", clearRoles);
calculateBtn.addEventListener("click", calculateAndShowTotals);
Array.from(tablinks).forEach((link) => {
link.addEventListener("click", function(event) {
openTab(event, this.getAttribute("data-tab"));
});

});

document.getElementById("buyTab").style.display = "block"; 
document
.querySelector(".tablinks[data-tab='buyTab']")
.classList.add("active");
}

function calculateDiscountedPrice(itemName, basePrice) {
let finalPrice = basePrice;
const activeRoles = Array.from(
document.querySelectorAll(".role-btn.active")
).map((btn) => btn.dataset.role);
activeRoles.forEach((role) => {
let roleDetails = roles[role];
if (roleDetails.discounts && roleDetails.discounts[itemName]) {
let discount = roleDetails.discounts[itemName] / 100;
finalPrice = Math.min(finalPrice, basePrice * (1 - discount));
}

if (roleDetails.bonuses && roleDetails.bonuses[itemName]) {
finalPrice = roleDetails.bonuses[itemName];
}

});

return finalPrice;
}

function clearAllTransactions() {
  document
    .querySelectorAll(".summary")
    .forEach((div) => (div.innerHTML = ""));
  
  updateSummaries();
  applyRoleBonuses(); 
}

function clearRoles() {
  document
    .querySelectorAll(".role-btn")
    .forEach((button) => button.classList.remove("active"));

  updateRoleEffects();
  applyRoleBonuses(); 
}

function calculateAndShowTotals() {
  let buyItems = Array.from(document.getElementById("buySummary").children);
  let sellItems = Array.from(document.getElementById("sellSummary").children);

  let buyDetails = "";
  let totalBuy = 0;

  buyItems.forEach((div) => {
    let name = div.dataset.itemName;
    let qty = parseInt(div.dataset.quantity);
    let basePrice = parseFloat(div.dataset.basePrice);
    let adjustedPrice = calculateDiscountedPrice(name, basePrice);
    let totalPrice = adjustedPrice * qty;
    totalBuy += totalPrice;
    buyDetails += `${name} x ${qty} = â‚µ${totalPrice.toLocaleString()}\n`;
  });

  let sellDetails = "";
  let totalSell = 0;

  sellItems.forEach((div) => {
    let name = div.dataset.itemName;
    let qty = parseInt(div.dataset.quantity);
    let basePrice = parseFloat(div.dataset.basePrice);
    let adjustedPrice = calculateDiscountedPrice(name, basePrice);
    let totalPrice = adjustedPrice * qty;
    totalSell += totalPrice;
    sellDetails += `${name} x ${qty} = â‚µ${totalPrice.toLocaleString()}\n`;
  });

// Role discounts
const hasRole = (role) =>
  document.querySelector(`.role-btn[data-role="${role}"]`)?.classList.contains("active");

let discount = 1.0;
let discountLabel = "";

if (hasRole("First Bloodz")) {
  discount = 0.75;
  discountLabel = " (First Bloodz 25% Off)";
} else if (hasRole("Time Served")) {
  discount = 0.80;
  discountLabel = " (Time Served 20% Off)";
} else if (
  hasRole("Veterans") ||
  hasRole("First Responders") ||
  hasRole("Health Providers")
) {
  discount = 0.90;
  if (hasRole("Veterans")) discountLabel = " (Veterans 10% Off)";
  if (hasRole("First Responders")) discountLabel = " (First Responders 10% Off)";
  if (hasRole("Health Providers")) discountLabel = " (Health Providers 10% Off)";
}

  let discountedBuy = totalBuy * discount;

  let bonusTotal = 0;
  document.querySelectorAll(".role-btn.active").forEach((btn) => {
  const role = btn.dataset.role;
  if (roleBonuses.hasOwnProperty(role)) {
    bonusTotal += roleBonuses[role];
   }
 });

  let finalTotal = discountedBuy + totalSell + bonusTotal;

  // Final message in the new order
  let message = `ðŸ§¾ Buy Summary:\n${buyDetails || "(No items)"}\n` +
                `ðŸ§¾ Sell Summary:\n${sellDetails || "(No items)"}\n` +
                `ðŸ’¸ Total Buy${discountLabel}: â‚µ${discountedBuy.toLocaleString()}\n` +
                `ðŸ’° Total Sell: â‚µ${totalSell.toLocaleString()}\n` +
                `ðŸŽ Role Bonus: â‚µ${bonusTotal.toLocaleString()}\n` +

                `ðŸ§® Final Total: â‚µ${finalTotal.toLocaleString()}`;

  document.getElementById("modalText").textContent = message;
document.getElementById("summaryModal").style.display = "block";

}

function calculateTotal(summaryDiv) {
return Array.from(summaryDiv.querySelectorAll("div")).reduce((acc, div) => {
let quantity = parseInt(div.dataset.quantity);
let itemName = div.dataset.itemName;
let basePrice = parseFloat(div.dataset.basePrice);
let adjustedPrice = calculateDiscountedPrice(itemName, basePrice);
return acc + adjustedPrice * quantity;
}, 0);

}

function openTab(evt, tabName) {
let tabcontent = document.getElementsByClassName("tabcontent");
let tablinks = document.getElementsByClassName("tablinks");
Array.from(tabcontent).forEach(
(content) => (content.style.display = "none")
);

Array.from(tablinks).forEach((link) => link.classList.remove("active"));
document.getElementById(tabName).style.display = "block";
evt.currentTarget.classList.add("active");
}

function updateSummaries() {
// Recalculate and update the summaries for both buy and sell tabs
["buy", "sell"].forEach((type) => {
const summaryDiv = document.getElementById(type + "Summary");
const summaryItems = summaryDiv.querySelectorAll("div");
summaryItems.forEach((div) => {
const itemName = div.dataset.itemName;
const quantity = parseInt(div.dataset.quantity);
const basePrice = parseFloat(div.dataset.basePrice);
const discountedPrice = calculateDiscountedPrice(itemName, basePrice);
const totalPrice = discountedPrice * quantity;

div.innerHTML = `${itemName} x ${quantity} = ${totalPrice.toFixed(0)} Cr <button class="removeOneBtn" style="background-color: orange;">x</button><button class="removeAllBtn" style="background-color: red;">x</button>`;

div.querySelector(".removeOneBtn").addEventListener("click", () => {
removeOneItem(div);
});

div.querySelector(".removeAllBtn").addEventListener("click", () => {
summaryDiv.removeChild(div);
updateSummaries();
});

});

});

}

function updateRoleEffects() {
  updateSummaries();
}

}); 
</script>
</body>
</html>